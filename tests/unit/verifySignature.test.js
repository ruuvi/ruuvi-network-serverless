const auth = require('../../Helpers/authHelper');

const timestamp = '1625657237';
const nonce = '1602508663';
const signature = 'ea2bc94b71cea6bd63515e60b362bcf7bffc335944fc3f78e97ccf9a029a7453';
const secret = '48:15:78:76:ED:F8:34:25';
const data = `{
	coordinates: '',
	timestamp: '1625657237',
	nonce: '1602508663',
	gw_mac: 'F9:15:8F:92:D8:69',
	tags: {
	  'C6:02:66:2B:09:C8': {
		rssi: -56,
		timestamp: '1625657235',
		data: '0201041BFF990405169C4274C850FC8401BC00A49BF612EFDBC602662B09C8'
	  },
	  'DC:E1:78:F9:1F:85': {
		rssi: -60,
		timestamp: '1625657235',
		data: '0201041BFF99040516E4434CC86BFE240070036451B66FBD6BDCE178F91F85'
	  },
	  'C5:AF:B9:B9:E8:52': {
		rssi: -54,
		timestamp: '1625657235',
		data: '0201061BFF990405EBA96907C995FFD0000C03F45C5678D30BC5AFB9B9E852'
	  },
	  'D0:C5:B0:0F:46:37': {
		rssi: -52,
		timestamp: '1625657235',
		data: '0201041BFF99040516994017C8CC016803EB0044611601B2DCD0C5B00F4637'
	  },
	  'FB:97:4E:97:DE:5C': {
		rssi: -61,
		timestamp: '1625657235',
		data: '0201061BFF99040516143BE8C8B9FBF8FFEC0050AE76449F02FB974E97DE5C'
	  },
	  'F7:71:BB:12:70:E1': {
		rssi: -47,
		timestamp: '1625657236',
		data: '0201061BFF9904051652538BC8920044FFBC041CA296ED94D1F771BB1270E1'
	  },
	  'E5:76:FD:F2:1A:2F': {
		rssi: -68,
		timestamp: '1625657234',
		data: '0201041BFF99040516843D9AC888FF280120FC849BF674E351E576FDF21A2F'
	  },
	  'CE:19:50:1D:50:A5': {
		rssi: -57,
		timestamp: '1625657236',
		data: '0201061BFF99040517085B41C8E20318FD4C005CBBB64DD2D8CE19501D50A5'
	  },
	  'F2:86:69:1B:B0:5A': {
		rssi: -57,
		timestamp: '1625657236',
		data: '0201041BFF990405165C4008C909FF78FF0003D4A136F3F171F286691BB05A'
	  },
	  'F6:81:DD:6E:FE:D8': {
		rssi: -29,
		timestamp: '1625657234',
		data: '0201061BFF99040518E24DAAC9440024002803FCA3F66C15B7F681DD6EFED8'
	  },
	  'C4:A3:42:45:02:3F': {
		rssi: -60,
		timestamp: '1625657236',
		data: '0201041BFF990405168F3C95C8A10000FFECFBF49AB612CC11C4A34245023F'
	  },
	  'DD:99:0A:C1:AA:B7': {
		rssi: -52,
		timestamp: '1625657235',
		data: '0201061BFF99040516235E20C853FE5400E0037CB51636CF8DDD990AC1AAB7'
	  },
	  'DF:06:DC:BA:79:3A': {
		rssi: -59,
		timestamp: '1625657235',
		data: '0201041BFF99040516DAFFFFFFFF038C0204002CA1B6666A77DF06DCBA793A'
	  },
	  'E9:D5:4B:FE:15:E7': {
		rssi: -52,
		timestamp: '1625657235',
		data: '0201041BFF99040516A157D5C8B6FFE4FFEC042875565058B4E9D54BFE15E7'
	  },
	  'DA:3E:ED:2B:0E:B9': {
		rssi: -66,
		timestamp: '1625657235',
		data: '0201041BFF99040516604041C96D00B803DCFFFC5616332890DA3EED2B0EB9'
	  },
	  'ED:1E:4E:19:B2:6D': {
		rssi: -50,
		timestamp: '1625657235',
		data: '0201061BFF9904051685436CC919000CFFF80408AA96B0F917ED1E4E19B26D'
	  },
	  'DA:C5:85:4C:6E:CC': {
		rssi: -52,
		timestamp: '1625657235',
		data: '0201061BFF99040516203BF5C882004CFFD0042CAC36DDCE44DAC5854C6ECC'
	  },
	  'E3:62:B1:5A:78:60': {
		rssi: -60,
		timestamp: '1625657233',
		data: '0201041BFF990405169C3E8EC873FFD0FF3003DC8896BC8849E362B15A7860'
	  },
	  'E7:AE:AB:82:FD:A9': {
		rssi: -49,
		timestamp: '1625657235',
		data: '0201061BFF99040516443CF3C8EEFC28009CFFE8AC36BB9F4EE7AEAB82FDA9'
	  },
	  'D2:CE:15:1E:30:9C': {
		rssi: -69,
		timestamp: '1625657235',
		data: '0201041BFF99040516753DA0C895FC3000380034A0D6030444D2CE151E309C'
	  },
	  'C0:4D:B1:4A:B6:35': {
		rssi: -64,
		timestamp: '1625657235',
		data: '0201041BFF990405165D3C46C91FFFBC003004008FB60D2F1AC04DB14AB635'
	  },
	  'F5:4F:92:06:77:95': {
		rssi: -68,
		timestamp: '1625657234',
		data: '0201041BFF9904051696487DC8DDFFE0FFBCFBCC8AD69BCC1DF54F92067795'
	  },
	  'EC:03:2B:EE:09:0A': {
		rssi: -65,
		timestamp: '1625657236',
		data: '02010611FF9904034D1B5FC8AD013200CCFC6D0B95'
	  },
	  'D4:94:E2:D7:E9:05': {
		rssi: -57,
		timestamp: '1625657235',
		data: '0201061BFF990405164B5368C88D003C000803D09B9620945DD494E2D7E905'
	  },
	  'E5:83:B4:04:90:52': {
		rssi: -62,
		timestamp: '1625657234',
		data: '0201061BFF99040515DA6B64C892005CFFBC0414A8D623D2AFE583B4049052'
	  },
	  'E0:E3:2B:22:F4:F5': {
		rssi: -61,
		timestamp: '1625657235',
		data: '0201061BFF990405004B5D10C8800020001004089DD67C7197E0E32B22F4F5'
	  }
	}
  }`;

test('verify validates correct signature', () => {
	const result = auth.validateSignature(signature, data, timestamp, 100000000000, secret);
	console.log(result);
	expect(result).toBe(false);
})
